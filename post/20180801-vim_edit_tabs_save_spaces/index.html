<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Python and Spaces and Tabs, Oh My! :: GameOver — A simple theme for Hugo</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://mattweidner.github.io/post/20180801-vim_edit_tabs_save_spaces/" />


<link rel="stylesheet" href="/assets/style.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="/assets/style.css">




<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Python and Spaces and Tabs, Oh My! :: GameOver — A simple theme for Hugo" />
<meta name="twitter:description" content="Python indentation The subject of Python source code indentation can be a contentious one. The Python style guide (PEP8) suggests that using four spaces per indentation level is the proper was to indent Python code. However, I have discovered I prefer to use tabs instead of spaces. Could I customize my text editor of choice, Vim, to edit using tabs and save to disk using spaces? Doing so would allow me to adhere to PEP8 when exchanging source code files with other programmers." />
<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image" content="https://mattweidner.github.ioimg/default.jpg">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Python and Spaces and Tabs, Oh My! :: GameOver — A simple theme for Hugo">
<meta property="og:description" content="" />
<meta property="og:url" content="https://mattweidner.github.io/post/20180801-vim_edit_tabs_save_spaces/" />
<meta property="og:site_name" content="Python and Spaces and Tabs, Oh My!" />
<meta property="og:image" content="https://mattweidner.github.ioimg/default.jpg">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2018-08-01 19:56:24 -0500 CDT" />







</head>
<body class="dark-theme">
<div class="container">
  <header class="header">
  <span class="header__inner">
    <a href="https://mattweidner.github.io" style="text-decoration: none;">
  <div class="logo">
    
      <span class="logo__mark">></span>
      <span class="logo__text">game_over</span>
      <span class="logo__cursor"></span>
    
  </div>
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner">
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/post/">Posts</a></li>
    
  </ul>
</nav>
        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


  <div class="content">
    
  <div class="post">
    <h2 class="post-title"><a href="https://mattweidner.github.io/post/20180801-vim_edit_tabs_save_spaces/">Python and Spaces and Tabs, Oh My!</a></h2>
    <div class="post-meta">
      <span class="post-date">
        2018-08-01
      </span>
      <span class="post-author">Written by Matt</span>
    </div>

    

    

    <div class="post-content">
      

<h2 id="python-indentation">Python indentation</h2>

<p>The subject of Python source code indentation can be a contentious one. The Python style guide (PEP8) suggests that using four spaces per indentation level is the proper was to indent Python code. However, I have discovered I prefer to use tabs instead of spaces. Could I customize my text editor of choice, Vim, to edit using tabs and save to disk using spaces? Doing so would allow me to adhere to PEP8 when exchanging source code files with other programmers.</p>

<h2 id="rendering-tabs-in-vim">Rendering tabs in Vim</h2>

<p>Vim can be configured to display a unique, visible, character on screen at the position of each tab character. I have this set to a unicode, vertical bar character. This makes indentation errors easy to see, and indentation easier to follow over large code blocks.</p>

<p><img src="https://lh3.googleusercontent.com/GilQvBgxmDk_GbRu5lqSvKY3a8yrZ2j482axG8z4bGUWQ8oupywJf-dAq7nK-NPLX0PgGMrBHNc" alt="vim tab rendering example" title="vim tab rendering example" /></p>

<p>In my case I chose a nice vertical bar <code>U+2502</code> from the box drawing set of characters (<a href="https://en.wikipedia.org/wiki/Box_Drawing">https://en.wikipedia.org/wiki/Box_Drawing</a>). In order to activate this feature, the vim <code>list</code> configuration options are added to the <code>.vimrc</code> configuration file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vim" data-lang="vim"><span style="color:#a6e22e">set</span> <span style="color:#a6e22e">list</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#a6e22e">set</span> <span style="color:#a6e22e">listchars</span>=<span style="color:#a6e22e">tab</span>:│\ ,<span style="color:#a6e22e">eol</span>:¬,<span style="color:#a6e22e">extends</span>:❯,<span style="color:#a6e22e">precedes</span>:\&lt;</code></pre></div>
<p>Listchars takes two characters for tab, so an escaped white space character is appended to the unicode character. I have also defined characters to show end-of-line markers and vim-specific line continuation markers <code>extends</code> and <code>precedes</code>.</p>

<h2 id="on-the-fly-re-indentation">On-the-fly re-indentation</h2>

<p>Now tab characters will be rendered in the editor window, but there is still a problem. Some source files use spaces for indentation, not tabs. Any Python source file that uses spaces for indentation will look like this:</p>

<p><img src="https://lh3.googleusercontent.com/lCclBPjXsn-yJ6TcB17qzgRY79t6R-ZQrybB7-y3PoUsqqh4q42bdMjZ--GryrQ5JsxgIRuM5Ks" alt="vim Python code with spaces" title="vim Python code with spaces" /></p>

<p>However, Vim autocommands can be used to replace spaces with tabs when reading in a Python source file, and reverse the operation when writing it back to disk. This can be achieved by defining two Vim functions and some autocommands in the <code>.vimrc</code> configuration file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vim" data-lang="vim"><span style="color:#66d9ef">function</span>! <span style="color:#a6e22e">PyExpandTabs</span>()<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">silent</span> <span style="color:#a6e22e">setlocal</span> <span style="color:#a6e22e">expandtab</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">silent</span> %<span style="color:#a6e22e">retab</span>!<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">endfunction</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">function</span>! <span style="color:#a6e22e">PyContractTabs</span>()<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">silent</span> <span style="color:#a6e22e">setlocal</span> <span style="color:#a6e22e">noexpandtab</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">silent</span> %<span style="color:#a6e22e">retab</span>!<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">endfunction</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#a6e22e">augroup</span> <span style="color:#a6e22e">python_files</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span>!<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">FileType</span> <span style="color:#66d9ef">python</span> setlocal noexpandtab<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">FileType</span> <span style="color:#66d9ef">python</span> set tabstop<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">FileType</span> <span style="color:#66d9ef">python</span> set shiftwidth<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">BufWritePre</span> *.<span style="color:#66d9ef">py</span> :call PyExpandTabs()<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">BufWritePost</span> *.<span style="color:#66d9ef">py</span> :call PyContractTabs()<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>        <span style="color:#a6e22e">autocmd</span> <span style="color:#a6e22e">BufReadPost</span> *.<span style="color:#66d9ef">py</span> :call PyContractTabs()<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#a6e22e">augroup</span> <span style="color:#a6e22e">END</span></code></pre></div>
<p>The first 3 <code>autocmd</code> statements sets up using tabs, equivalent to 4 spaces, when editing a Python source file. The last 3 statements trigger upon reading and writing a Python source file to disk. <code>BufWritePre</code> calls the user-defined Vim function PyExpandTabs() just before writing an edited buffer to disk. The PyExpandTabs() function replaces all the tabs in the source file being edited with spaces. <code>BufWritePost</code> triggers after that file has been written to disk to reverse the change and replace the spaces with tabs to allow us to continue editing with our favorite indentation method. <code>BufReadPost</code> also calls PyContractTabs() right after a file has been loaded into a Vim edit buffer, but before passing control to the user. PyContractTabs() replaces leading spaces with tabs.</p>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://mattweidner.github.io/post/20181116-multiprocessing_with_python/">
                <span class="button__icon">←</span>
                <span class="button__text">Parallel Multiprocessing with Python</span>
              </a>
            </span>
          
          
        </div>
      </div>
    
  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <a href="https://mattweidner.github.io" style="text-decoration: none;">
  <div class="logo">
    
      <span class="logo__mark">></span>
      <span class="logo__text">game_over</span>
      <span class="logo__cursor"></span>
    
  </div>
</a>

      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
        <span>Theme created by <a href="https://twitter.com/panr">panr</a></span>
      </div>
    
  </div>
</footer>


  <script src="/assets/main.js"></script>

  <script src="/assets/prism.js"></script>



  
</div>

</body>
</html>
